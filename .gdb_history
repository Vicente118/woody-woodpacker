b generate_tea_key
r test
ni
layout asm
ni
tui disable
ni
ni
ni
print %rax
print $rax
print &tea_key
x/16b 0x4030d8
x/16b *0x4030d8
x/16b 0x4030d8
x/24b 0x4030d8
x/32b 0x4030d8
x/32s 0x4030d8
x/32c 0x4030d8
x/32x 0x4030d8
clear
cd
b parse_elf_headers
r test
ni
ni
print $rax
clear
clear
b find_code_segment
r test
layout asm
ni
ni
q
b find_code_segment
r test
ni
ni
ni
layout asm
ni
b *0x4012fa
c
ni
print $rax
ni
print $rax
ni
print $rax
ni
print $rax
print &new_entrypoint 
layout asm
tui disable
print &new_entrypoint 
x/4d 0x402090
x/4d *0x402090
x/4d 0x402090
x/8d 0x402090
print &injection_point
x/8d 0x4020d8
print $eax
printf %d 0x1180
ni
print $ra
print $rax
ni
print $rax
print &code_segment_vaddr
x/4x 0x4020d0
q
b patch_stub
r test
ni
r test
ni
r test
ni
b patch_stub 
r test
ni
b patch_stub 
r test
ni
ni
ni
print $rbx
ni
print $rax
print $rdx
print $rbx
clear
print $rbx
print $rdx
print &original_entry 
x/4x 0x4020a8
print 0x0000000000001060 - 0x4015b3
b patch_stub 
r test
ni
print $rbx

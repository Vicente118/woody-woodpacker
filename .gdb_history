clear
b _start
r /usr/bin/ls
layout asm
ni
print $rax
ni
q
b main
r
ni
ni
clear
q
r test
b encrypt_code_segment
r test
ni
s
ni
print $eax
print $ebx
c
q
b main
r
print $r8
print $r9
print $r10
print $r12
print $r13
print $r14
print $r15
print $rqx
print $rax
print $rbx
print $rcx
print $rdx
clear
q
b patch_stub
set disassembly-flavor intel
r
r test
ni
ni
print $rax
ni
print $rax
ni
print $rax
ni
ni
print $rax
ni
print $rax
ni
print $rax
print tea_key
print &tea_key
x/16x 0x403108
print &code_segment_offset 
x/4x 0x4020e8
print &code_segment_size
x/8x 0x4020f0
b encrypt_code_segment
r test
c
r test
b encrypt_code_segment
c
make re
make re
b encrypt_code_segment
r test
ni
print $rcx
b find_code_segment
c
c
r test
layout asm
r
b encrypt_code_segment
r test
layout asm
c
b find_code_segment
r test
b *0x4012ee
c
ni
print $rqx
print $rax
q
starti
b _dl_start_user 
c
ni
ni
r
ni
b
del 1
ni
si
r test
q
b _start 
r
c
r test
ni
layout asm
q
b patch_stub
r
r tet
r test
ni
q
starti
ni
starti
ni
q
starti
ni
s
starti
ni
si
ni
ni
s
i
ni
c
q
